# æ™ºèƒ½é—®ç­” Agent æŠ€æœ¯æ–¹æ¡ˆ
### æ ¸å¿ƒæ¦‚å¿µ
- **é¡¹ç›®åç§°**: SmartQA Agent - æ™ºèƒ½é—®ç­”åŠ©æ‰‹
- **æŠ€æœ¯æ ¸å¿ƒ**: RAG (Retrieval-Augmented Generation) + Agentæ¶æ„ + DeepSeekæ¨¡å‹
- **æ ¸å¿ƒç›®æ ‡**: åŸºäºçŸ¥è¯†åº“çš„å‡†ç¡®ã€å¯é çš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿ
- **æŠ€æœ¯æ ˆ**: Spring AI + DeepSeek + å‘é‡æ•°æ®åº“ + æ£€ç´¢å¢å¼º + Agentå†³ç­–

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„æ¦‚è§ˆ
```mermaid
graph TB
    A[ç”¨æˆ·æé—®] --> B[é—®ç­”Agentåè°ƒå™¨]
    B --> C[æŸ¥è¯¢ç†è§£æ¨¡å—]
    B --> D[RAGæ£€ç´¢å¼•æ“]
    B --> E[ç­”æ¡ˆç”Ÿæˆæ¨¡å—]
    
    C --> F[æ„å›¾è¯†åˆ«]
    C --> G[æŸ¥è¯¢é‡å†™]
    C --> H[å®ä½“è¯†åˆ«]
    
    D --> I[å‘é‡æ£€ç´¢]
    D --> J[å…³é”®è¯æ£€ç´¢]
    D --> K[æ··åˆæ’åº]
    
    E --> L[ä¸Šä¸‹æ–‡æ„å»º]
    E --> M[æç¤ºè¯å·¥ç¨‹]
    E --> N[DeepSeekæ¨¡å‹]
    
    I --> O[å‘é‡æ•°æ®åº“]
    J --> P[å…¨æ–‡æœç´¢å¼•æ“]
    N --> Q[DeepSeek API]
    
    O --> R[çŸ¥è¯†åº“å‘é‡]
    P --> S[ç»“æ„åŒ–çŸ¥è¯†]
    
    B --> T[ç­”æ¡ˆéªŒè¯]
    T --> U[ç½®ä¿¡åº¦è¯„ä¼°]
    T --> V[æº¯æºéªŒè¯]
```

---

## ğŸ“‹ æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 1. é—®ç­”Agentåè°ƒå™¨
**èŒè´£**: åè°ƒæ•´ä¸ªé—®ç­”æµç¨‹ï¼Œåˆ¶å®šå›ç­”ç­–ç•¥
- **è¾“å…¥åˆ†æ**: è§£æç”¨æˆ·é—®é¢˜ç±»å‹å’Œå¤æ‚åº¦
- **æµç¨‹å†³ç­–**: é€‰æ‹©å•è½®æ£€ç´¢æˆ–å¤šè½®å¤æ‚å¤„ç†
- **è´¨é‡æŠŠæ§**: ç›‘æ§å„ç¯èŠ‚è´¨é‡ï¼Œç¡®ä¿æœ€ç»ˆç­”æ¡ˆå¯é æ€§

### 2. RAGæ£€ç´¢å¼•æ“
**èŒè´£**: ä»çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ç‰‡æ®µ
- **å¤šè·¯æ£€ç´¢**: å‘é‡æ£€ç´¢ + å…³é”®è¯æ£€ç´¢æ··åˆ
- **é‡æ’åº**: åŸºäºç›¸å…³æ€§ã€æ—¶æ•ˆæ€§ã€æƒå¨æ€§ç»¼åˆæ’åº
- **ä¸Šä¸‹æ–‡é€‰æ‹©**: é€‰æ‹©æœ€ç›¸å…³çš„çŸ¥è¯†ç‰‡æ®µæ„å»ºä¸Šä¸‹æ–‡

### 3. æŸ¥è¯¢ç†è§£æ¨¡å—
**èŒè´£**: æ·±åº¦ç†è§£ç”¨æˆ·æŸ¥è¯¢æ„å›¾
- **æ„å›¾åˆ†ç±»**: åŒºåˆ†äº‹å®æŸ¥è¯¢ã€è§£é‡Šæ€§æŸ¥è¯¢ã€æ“ä½œæŒ‡å¯¼ç­‰
- **æŸ¥è¯¢æ‰©å±•**: åŸºäºåŒä¹‰è¯ã€ç›¸å…³æ¦‚å¿µæ‰©å±•æŸ¥è¯¢
- **å®ä½“é“¾æ¥**: è¯†åˆ«å¹¶é“¾æ¥åˆ°çŸ¥è¯†åº“ä¸­çš„å®ä½“

### 4. ç­”æ¡ˆç”Ÿæˆæ¨¡å—ï¼ˆé›†æˆDeepSeekï¼‰
**èŒè´£**: åŸºäºæ£€ç´¢ç»“æœä½¿ç”¨DeepSeekç”Ÿæˆè‡ªç„¶è¯­è¨€ç­”æ¡ˆ
- **ä¸Šä¸‹æ–‡æ„å»º**: ç»„ç»‡æ£€ç´¢åˆ°çš„ä¿¡æ¯ç‰‡æ®µ
- **æç¤ºè¯ä¼˜åŒ–**: è®¾è®¡é’ˆå¯¹ä¸åŒé—®é¢˜ç±»å‹çš„æç¤ºè¯
- **ç­”æ¡ˆåˆæˆ**: ä½¿ç”¨DeepSeekç”Ÿæˆå‡†ç¡®ã€ç®€æ´ã€æ˜“æ‡‚çš„ç­”æ¡ˆ

---

## ğŸ—ƒï¸ çŸ¥è¯†åº“æ¶æ„

### çŸ¥è¯†æºç®¡ç†
```
knowledge_sources/
â”œâ”€â”€ ç»“æ„åŒ–çŸ¥è¯†/
â”‚   â”œâ”€â”€ äº§å“æ–‡æ¡£/
â”‚   â”œâ”€â”€ APIæ–‡æ¡£/
â”‚   â””â”€â”€ é…ç½®æ‰‹å†Œ/
â”œâ”€â”€ éç»“æ„åŒ–çŸ¥è¯†/
â”‚   â”œâ”€â”€ æŠ€æœ¯åšå®¢/
â”‚   â”œâ”€â”€ é—®é¢˜è§£ç­”/
â”‚   â””â”€â”€ æœ€ä½³å®è·µ/
â””â”€â”€ å®æ—¶çŸ¥è¯†/
    â”œâ”€â”€ äº§å“æ›´æ–°/
    â”œâ”€â”€ å¸¸è§é—®é¢˜/
    â””â”€â”€ æ•…éšœæ’é™¤/
```

### å‘é‡åŒ–ç­–ç•¥
- **åˆ†å—ç­–ç•¥**: æŒ‰è¯­ä¹‰è¾¹ç•Œåˆ†å—ï¼Œé‡å å¤„ç†
- **åµŒå…¥æ¨¡å‹**: é€‰æ‹©é€‚åˆé¢†åŸŸçš„ä¸­æ–‡åµŒå…¥æ¨¡å‹
- **å…ƒæ•°æ®**: æ·»åŠ æ¥æºã€æ›´æ–°æ—¶é—´ã€æƒå¨æ€§ç­‰å…ƒæ•°æ®

---

## ğŸ”„ å·¥ä½œæµç¨‹è®¾è®¡

### æ ‡å‡†é—®ç­”æµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as Agentåè°ƒå™¨
    participant Q as æŸ¥è¯¢ç†è§£
    participant R as RAGæ£€ç´¢
    participant G as ç­”æ¡ˆç”Ÿæˆ
    participant D as DeepSeek
    participant V as ç­”æ¡ˆéªŒè¯
    
    U->>A: æäº¤é—®é¢˜
    A->>Q: åˆ†ææŸ¥è¯¢æ„å›¾
    Q->>A: è¿”å›æŸ¥è¯¢åˆ†æ
    A->>R: æ‰§è¡Œæ£€ç´¢
    R->>A: è¿”å›ç›¸å…³æ–‡æ¡£
    A->>G: ç”Ÿæˆç­”æ¡ˆ
    G->>D: è°ƒç”¨DeepSeekç”Ÿæˆ
    D->>G: è¿”å›ç”Ÿæˆç»“æœ
    G->>A: è¿”å›åˆå§‹ç­”æ¡ˆ
    A->>V: éªŒè¯ç­”æ¡ˆè´¨é‡
    V->>A: è¿”å›éªŒè¯ç»“æœ
    A->>U: è¿”å›æœ€ç»ˆç­”æ¡ˆ
```

### å¤æ‚é—®é¢˜å¤„ç†æµç¨‹
```mermaid
graph TB
    A[å¤æ‚é—®é¢˜] --> B[é—®é¢˜åˆ†è§£]
    B --> C[å­é—®é¢˜1]
    B --> D[å­é—®é¢˜2]
    B --> E[å­é—®é¢˜3]
    
    C --> F[RAGæ£€ç´¢]
    D --> F
    E --> F
    
    F --> G[å­ç­”æ¡ˆç”Ÿæˆ]
    G --> H[ç­”æ¡ˆåˆæˆ]
    H --> I[ä¸€è‡´æ€§æ£€æŸ¥]
    I --> J[æœ€ç»ˆç­”æ¡ˆ]
```

---

## ğŸ¯ Agentå†³ç­–é€»è¾‘

### é—®é¢˜ç±»å‹è¯†åˆ«
| é—®é¢˜ç±»å‹ | å¤„ç†ç­–ç•¥ | æ£€ç´¢æ–¹å¼ | ç”Ÿæˆæ–¹å¼ |
| :--- | :--- | :--- | :--- |
| **äº‹å®æŸ¥è¯¢** | ç›´æ¥æ£€ç´¢ | ç²¾ç¡®åŒ¹é… | ç®€æ´äº‹å® |
| **è§£é‡Šæ€§æŸ¥è¯¢** | æ¦‚å¿µæ£€ç´¢ | è¯­ä¹‰æ£€ç´¢ | è¯¦ç»†è§£é‡Š |
| **æ“ä½œæŒ‡å¯¼** | æ­¥éª¤æ£€ç´¢ | è¿‡ç¨‹æ£€ç´¢ | æ­¥éª¤åŒ–æŒ‡å¯¼ |
| **æ¯”è¾ƒåˆ†æ** | å¤šæ¦‚å¿µæ£€ç´¢ | å¯¹æ¯”æ£€ç´¢ | å¯¹æ¯”åˆ†æ |
| **åˆ›æ„ç”Ÿæˆ** | çµæ„Ÿæ£€ç´¢ | å…³è”æ£€ç´¢ | åˆ›æ„æ‰©å±• |

### ç½®ä¿¡åº¦ç®¡ç†
- **é«˜ç½®ä¿¡åº¦**: ç›´æ¥è¿”å›ç­”æ¡ˆ
- **ä¸­ç½®ä¿¡åº¦**: æ·»åŠ ä¸ç¡®å®šæ€§è¯´æ˜
- **ä½ç½®ä¿¡åº¦**: å»ºè®®ç”¨æˆ·é‡æ–°è¡¨è¿°æˆ–æä¾›æ›´å¤šä¿¡æ¯

---

## ğŸ”§ æŠ€æœ¯ç»„ä»¶è®¾è®¡

### 1. å‘é‡æ£€ç´¢æœåŠ¡
```java
// ä¼ªä»£ç  - æ£€ç´¢æœåŠ¡æ¥å£
public interface RetrievalService {
    List<KnowledgeChunk> retrieve(Query query, int topK);
    List<KnowledgeChunk> hybridRetrieve(Query query, int topK);
    double calculateRelevance(Query query, KnowledgeChunk chunk);
}
```

### 2. é—®ç­”ç”ŸæˆæœåŠ¡ï¼ˆDeepSeeké›†æˆï¼‰
```java
// ä¼ªä»£ç  - ç”ŸæˆæœåŠ¡æ¥å£
public interface AnswerGenerationService {
    Answer generateAnswer(Query query, List<KnowledgeChunk> context);
    Answer generateWithVerification(Query query, List<KnowledgeChunk> context);
    String buildPrompt(Query query, List<KnowledgeChunk> context, AnswerStyle style);
}

// DeepSeeké›†æˆæœåŠ¡
@Service
public class DeepSeekService {
    private final OpenAiChatClient chatClient;

    public DeepSeekService(OpenAiChatClient chatClient) {
        this.chatClient = chatClient;
    }

    public String generateAnswer(String prompt) {
        return chatClient.call(prompt);
    }
}
```

### 3. Agentåè°ƒæœåŠ¡
```java
// ä¼ªä»£ç  - Agentåè°ƒæ¥å£
public interface QAAgent {
    AgentResponse processQuestion(UserQuestion question);
    QuestionAnalysis analyzeQuestion(UserQuestion question);
    AnswerPlan createAnswerPlan(QuestionAnalysis analysis);
    Answer executeAnswerPlan(AnswerPlan plan);
}
```

---

## âš™ï¸ ç³»ç»Ÿé…ç½®æ–¹æ¡ˆ

### DeepSeeké…ç½®
```yaml
spring:
  ai:
    openai:
      api-key: ${DEEPSEEK_API_KEY}
      base-url: https://api.deepseek.com/v1
      chat:
        options:
          model: deepseek-chat
          temperature: 0.1
          max-tokens: 2000
```

### RAGé…ç½®å‚æ•°
```yaml
rag:
  retrieval:
    vector-weight: 0.7
    keyword-weight: 0.3
    top-k-initial: 20
    top-k-final: 5
    similarity-threshold: 0.7
    
  generation:
    max-context-length: 4000
    include-sources: true
    confidence-threshold: 0.8
    
  knowledge-base:
    chunk-size: 512
    chunk-overlap: 50
    update-interval: 3600
```

### Agentå†³ç­–é…ç½®
```yaml
agent:
  question-classification:
    enabled: true
    model: "question-classifier"
    
  answer-strategy:
    simple-query: "direct-retrieval"
    complex-query: "multi-step"
    ambiguous-query: "clarification"
    
  quality-control:
    enable-verification: true
    min-confidence: 0.6
    fallback-strategy: "suggest-alternative"
```

---

## ğŸ“Š æ€§èƒ½ä¸æ‰©å±•è®¾è®¡

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
- **ç¼“å­˜å±‚**: é«˜é¢‘é—®é¢˜å’Œç­”æ¡ˆç¼“å­˜
- **å¼‚æ­¥å¤„ç†**: å¤æ‚é—®é¢˜å¼‚æ­¥å¤„ç†
- **æ‰¹é‡æ£€ç´¢**: æ‰¹é‡å¤„ç†ç›¸ä¼¼æŸ¥è¯¢
- **ç´¢å¼•ä¼˜åŒ–**: å¤šçº§ç´¢å¼•ç»“æ„

### æ‰©å±•æ€§è®¾è®¡
- **æ¨¡å—åŒ–æ¶æ„**: å„ç»„ä»¶å¯ç‹¬ç«‹æ‰©å±•
- **æ’ä»¶æœºåˆ¶**: æ”¯æŒæ–°çš„æ£€ç´¢å™¨å’Œç”Ÿæˆå™¨
- **é…ç½®é©±åŠ¨**: è¡Œä¸ºé€šè¿‡é…ç½®è°ƒæ•´
- **ç›‘æ§æŒ‡æ ‡**: å…¨é¢çš„æ€§èƒ½ç›‘æ§

---

## ğŸ›¡ï¸ è´¨é‡ä¿éšœä½“ç³»

### ç­”æ¡ˆè´¨é‡è¯„ä¼°
- **ç›¸å…³æ€§**: ç­”æ¡ˆä¸é—®é¢˜çš„åŒ¹é…ç¨‹åº¦
- **å‡†ç¡®æ€§**: äº‹å®çš„æ­£ç¡®æ€§
- **å®Œæ•´æ€§**: ä¿¡æ¯è¦†ç›–å…¨é¢æ€§
- **å¯è¯»æ€§**: è¯­è¨€è¡¨è¾¾æ¸…æ™°åº¦

### æº¯æºä¸éªŒè¯
- **æ¥æºæ ‡æ³¨**: æ¯ä¸ªäº‹å®æ ‡æ³¨çŸ¥è¯†æ¥æº
- **ç½®ä¿¡åº¦è¯„åˆ†**: åŸºäºå¤šä¸ªç»´åº¦çš„ç½®ä¿¡åº¦è®¡ç®—
- **ç”¨æˆ·åé¦ˆ**: åŸºäºç”¨æˆ·åé¦ˆæŒç»­ä¼˜åŒ–

---

## ğŸš€ éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ
```
å•ä½“æ¶æ„:
â”œâ”€â”€ Spring Bootåº”ç”¨
â”œâ”€â”€ å‘é‡æ•°æ®åº“ (Chroma)
â”œâ”€â”€ å…³ç³»æ•°æ®åº“ (MySQL)
â”œâ”€â”€ ç¼“å­˜ (Redis)
â””â”€â”€ æœç´¢å¼•æ“ (Elasticsearch)
```

### ç”Ÿäº§ç¯å¢ƒ
```
å¾®æœåŠ¡æ¶æ„:
â”œâ”€â”€ é—®ç­”AgentæœåŠ¡
â”œâ”€â”€ æ£€ç´¢æœåŠ¡
â”œâ”€â”€ ç”ŸæˆæœåŠ¡ï¼ˆDeepSeeké›†æˆï¼‰
â”œâ”€â”€ çŸ¥è¯†åº“ç®¡ç†æœåŠ¡
â””â”€â”€ ç”¨æˆ·ä¼šè¯æœåŠ¡
```

---

## ğŸ“ˆ æ¼”è¿›è·¯çº¿

### Phase 1: åŸºç¡€RAG (2-3å‘¨)
- [ ] åŸºç¡€æ£€ç´¢å’Œç”Ÿæˆæµç¨‹
- [ ] DeepSeekæ¨¡å‹é›†æˆ
- [ ] ç®€å•é—®ç­”åœºæ™¯æ”¯æŒ
- [ ] åŸºç¡€çŸ¥è¯†åº“æ„å»º

### Phase 2: Agentå¢å¼º (2-3å‘¨)
- [ ] é—®é¢˜åˆ†ç±»å’Œç­–ç•¥é€‰æ‹©
- [ ] å¤šæ­¥æ¨ç†èƒ½åŠ›
- [ ] ç­”æ¡ˆéªŒè¯æœºåˆ¶

### Phase 3: é«˜çº§åŠŸèƒ½ (2-3å‘¨)
- [ ] å¤šè½®å¯¹è¯æ”¯æŒ
- [ ] ä¸ªæ€§åŒ–å›ç­”
- [ ] å®æ—¶çŸ¥è¯†æ›´æ–°

### Phase 4: ä¼˜åŒ–éƒ¨ç½² (1-2å‘¨)
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ç›‘æ§å‘Šè­¦
- [ ] ç”Ÿäº§éƒ¨ç½²

---

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### æ ¸å¿ƒåˆ›æ–°ç‚¹
1. **æ™ºèƒ½Agentå†³ç­–**: åŸºäºé—®é¢˜å¤æ‚åº¦çš„è‡ªé€‚åº”å¤„ç†ç­–ç•¥
2. **æ··åˆæ£€ç´¢ç­–ç•¥**: å‘é‡+å…³é”®è¯+è§„åˆ™çš„æ··åˆæ£€ç´¢
3. **DeepSeeké›†æˆ**: åˆ©ç”¨é«˜æ€§èƒ½ä¸­æ–‡å¤§æ¨¡å‹ç”Ÿæˆç­”æ¡ˆ
4. **è´¨é‡ä¿éšœä½“ç³»**: å¤šå±‚æ¬¡çš„ç­”æ¡ˆè´¨é‡éªŒè¯
5. **å¯è§£é‡Šæ€§**: å®Œæ•´çš„ç­”æ¡ˆæº¯æºå’Œç½®ä¿¡åº¦è¯´æ˜

### ä¸šåŠ¡ä»·å€¼
- æä¾›å‡†ç¡®å¯é çš„æ™ºèƒ½é—®ç­”æœåŠ¡
- æ”¯æŒå¤æ‚é—®é¢˜çš„æ·±åº¦è§£ç­”
- å…·å¤‡æŒç»­å­¦ä¹ å’Œæ”¹è¿›èƒ½åŠ›
- å¯åº”ç”¨äºå¤šä¸ªé¢†åŸŸçš„çŸ¥è¯†é—®ç­”åœºæ™¯

è¿™ä¸ªæŠ€æœ¯æ–¹æ¡ˆæä¾›äº†ä¸€ä¸ªå®Œæ•´çš„æ™ºèƒ½é—®ç­”Agentè®¾è®¡æ¡†æ¶ï¼Œé›†æˆäº†DeepSeekå¤§æ¨¡å‹ï¼Œæ—¢åŒ…å«äº†æ ¸å¿ƒæŠ€æœ¯ç»„ä»¶ï¼Œåˆè€ƒè™‘äº†å®é™…éƒ¨ç½²å’Œæ‰©å±•éœ€æ±‚ï¼Œå¯ä»¥ä½œä¸ºé¡¹ç›®å¼€å‘çš„è¯¦ç»†æŒ‡å¯¼æ–¹æ¡ˆã€‚